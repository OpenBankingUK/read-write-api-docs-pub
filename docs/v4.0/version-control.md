# Version control


v4.0 - 27th June 2024

| Area | Changes |
| --- | --- |
| All | <ul><li>[Enum/codeset repository](https://github.com/OpenBankingUK/External_Internal_CodeSets) created on GitHub. OBL enums have been removed from namespaced enumeration page and participants should refer to this respository for values. Note, OBExternal* enum names have been updated to OBInternal*</li><li>New optional `StatusReason` array containing 0..*:<ul><li>`StatusReasonCode`</li><li>`Path`</li><li>`StatusReasonDescription`</li></ul></li><li>Sequence diagrams and consent status models updated with ISO values</li><li>Usage examples updated</li></ul> |
| All | Alignment with ISO 20022:<br><ul><li>ISO code names replaced by code value (e.g. `AcceptedWithoutPosting` is now `ACWP`)</li><li>Address fields aligned to ISO definition and rationalised into single address definition `OBPostalAddress7`.</li><li>`LEI` added to Creditor/Debtor/CreditorAgent objects</li><li>`UltimateCreditor` and `UltimateDebtor` added</li><li>`MandateRelatedInformation` added to DirectDebit and StandingOrder, this object replaces some fields from v3.1.11</li><li>`RemittanceInformation` object updated to ISO format, this replaces ‘reference’ in payment requests. The object name has been updated to `OBRemittanceInformation2`.</li><li>`CreditorAccount` & `CreditorAgent` now have the same (optional) fields across API endpoints</li><li>`Proxy` added to CreditorAccount/DebtorAccount (across AISP, PISP & CBPII)</li></ul> |
| AISP |ISO 20022 changes<br><ul><li>`AccountType` (OBExternalAccountType1Code) renamed to `AccountCategory` (OBInternalAccountType1Code)<li>`AccountSubType` renamed to `AccountTypeCode`</li><li>`MORT` (Mortgage) and `WALT` (Wallet) added to OBExternalAccountSubType1Code</li><li>`Name` added to Servicer in OBReadAccount6</li><li>`StatementFrequencyAndFormat` added to Account in OBReadAccount6</li><li>`PaymentPurposeCode` added to Transaction in OBReadTransaction6</li><li>`CategoryPurposeCode` added to Transaction in OBReadTransaction6</li></ul> |
| PISP | ISO20022 changes<br><ul><li>`CategoryPurposeCode` added to Risk object</li><li>`RemittanceInformation` added to payments</li><li>`RegulatoryReporting` added to payments</li></ul> |
| Errors | <ul><li>Simplified error object, top level `Code` and `Message` have been marked as optional and __deprecated__.</li><li>Error codes now in ISO 20022 code value format (4 chars) in the `OBExternalStatusReason1Code` enum</li><li>Additional guidance on errors experienced in the redirect flow or from PSU initiated changes</li></ul> |
| VRP | <ul><li>`ContractPresentIndicator` typo fixed</li><li>Added guidance on dynamic reference information for VRP payments</li><li>StatusReason now uses ExternalStatusReason1Code</li><li>To assist with version migration:<ul><li>Introduced optional HTTP PUT/PATCH verbs for consents</li><li>Added payload version header</li></ul></li></ul> |
| Payments | <ul><li>Updated payment message types information to include ISO 20022 changes, CHAPS migration and CBPR+</li><li>Richer payment status information aligned to ISO 20022 `ExternalTransactionStatus1code`</li></ul></li></ul>|
| Various | All [3.1.11 KI’s](https://openbanking.atlassian.net/wiki/spaces/DZ/pages/47546479/Known+Specification+Issues) addressed |
| AISP | <ul><li>Added new `ExtendedProprietaryBankTransactionCodes` array to Transactions (TDA decision 264)</li><li>Permission code table updated with `UltimateCreditor`, `UltimateDebtor` and `StatementFrequencyAndFormat`</li></ul> |
| Various|`Frequency` in `OBMandateRelatedInformation1` object made mandatory |
| PISP| `CreditorAgent` added to <ul><li>Domestic Payment Consent</li><li>Domestic Payment</li><li>File payment Consents</li><li>File payment</li></ul> | 
| Security Profile | The Security Profile has been updated to [FAPI 1 Advanced](https://openid.net/specs/openid-financial-api-part-2-1_0.html) |



v4.0 - 4th September 2024

| Path/Area | Issue |
| --- | --- |
| [OBReadConsentResponse1](https://openbankinguk.github.io/spec-preview-268/v4.0/resources-and-data-models/aisp/account-access-consents.html#data-dictionary-2) | Status is listed as 0..</span>1 in datadictionary but correctly shown as 1..1 in UML |
| [OBReadConsentResponse1](https://openbankinguk.github.io/spec-preview-268/v4.0/resources-and-data-models/aisp/account-access-consents.html#data-dictionary-2) | Codeset class listed as OBInternalPermissions1Code instead of OBInternalConsentStatus1Code |
| [OBReadAccount6/Data/Account/StatementFrequencyAndFormat/Format](https://openbankinguk.github.io/spec-preview-268/v4.0/resources-and-data-models/aisp/Accounts.html#data-dictionary) | Codeset repo value from row above has duplicated down |
| [OBReadTransaction6/Data/Transaction/PaymentPurposeCode](https://openbankinguk.github.io/spec-preview-268/v4.0/resources-and-data-models/aisp/Transactions.html#data-dictionary) | Codeset repo link has duplicated across rows and link is unclickable |
| [OBReadStandingOrder6/Data/StandingOrder/NextPaymentDateTime](https://openbankinguk.github.io/spec-preview-268/v4.0/resources-and-data-models/aisp/standing-orders.html#data-dictionary) | Class type text has truncated and is showing as ISODate |
| [OBReadStandingOrder6](https://openbankinguk.github.io/spec-preview-268/v4.0/resources-and-data-models/aisp/standing-orders.html#data-dictionary) | RemittanceInformation missing from AISP Standing Order Data Dictionary |
| [OBReadOffer1/Data/Offer/OfferType](https://openbankinguk.github.io/spec-preview-268/v4.0/resources-and-data-models/aisp/Offers.html#data-dictionary) | Codeset should be OBExternalOfferType1Code in data dictionary |
| [OBFundsConfirmationConsentResponse1/Data/Status](https://openbankinguk.github.io/spec-preview-268/v4.0/resources-and-data-models/cbpii/funds-confirmation-consent.html#data-dictionary-2) | Status is listed as 0..1 in data dictionary | 
| [OBFundsConfirmationConsentResponse1](https://openbankinguk.github.io/spec-preview-268/v4.0/resources-and-data-models/cbpii/funds-confirmation-consent.html#uml-diagram-2) | UML diagram showing cached version with ‘StatusCode’ fro, original draft release |
| [OBFundsConfirmationConsentResponse1](https://openbankinguk.github.io/spec-preview-268/v4.0/resources-and-data-models/cbpii/funds-confirmation-consent.html#data-dictionary-2) | OBInternalPermissions1Code has duplicated across rows |
| [OBFundsConfirmationConsentResponse1/Data/StatusReason/StatusReasonDescription](https://openbankinguk.github.io/spec-preview-268/v4.0/resources-and-data-models/cbpii/funds-confirmation-consent.html#data-dictionary-2) | Field length is missing from table | 
| [OBDomesticVRPConsentRequest](https://openbankinguk.github.io/spec-preview-268/v4.0/resources-and-data-models/vrp/domestic-vrp-consents.html#obdomesticvrpconsentrequest) | Data element occurrence showing as 0..1 in data dictionary but correctly shown as 1..1 in UML |
| [OBDomesticVRPConsentResponse](https://openbankinguk.github.io/spec-preview-268/v4.0/resources-and-data-models/vrp/domestic-vrp-consents.html#obdomesticvrpconsentresponse) | StatusReason/Path not showing in data dictionary |
| [OBDomesticVRPResponse](https://openbankinguk.github.io/spec-preview-268/v4.0/resources-and-data-models/vrp/domestic-vrps.html#obdomesticvrpresponse) | Data.StatusReason. StatusReasonDescription max length is listed as 256 instead of 500. |
| [OBDomestic2/CreditorAgent/SchemeName](https://openbankinguk.github.io/spec-preview-268/v4.0/resources-and-data-models/pisp/domestic-payment-consents.html#data-dictionary) | Table is missing link to codeset repo |
| [OBDomestic2/CreditorAgent/LEI](https://openbankinguk.github.io/spec-preview-268/v4.0/resources-and-data-models/pisp/domestic-payment-consents.html#data-dictionary) | Missing from table but present in UML |
| [OBWriteDomesticConsentResponse5/Data/Status](https://openbankinguk.github.io/spec-preview-268/v4.0/resources-and-data-models/pisp/domestic-payment-consents.html#data-dictionary-3) | Codeset listed is legacy value |
| [OBWriteDomesticConsentResponse5/Data/StatusReason/StatusReasonCode](https://openbankinguk.github.io/spec-preview-268/v4.0/resources-and-data-models/pisp/domestic-payment-consents.html#data-dictionary-3) | Codeset should be OBExternalStatusReason1Code in data dictionary |
| [SCASupportData/RequestedSCAExemptionType](https://openbankinguk.github.io/spec-preview-268/v4.0/profiles/payment-initiation-api-profile.html#data-dictionary-8) | Description should be “This field allows a PISP to request specific SCA Exemption for a Payment Initiation” |
| [GET /domestic-payment-consents/{ConsentId}/funds-confirmation description](https://openbankinguk.github.io/spec-preview-268/v4.0/resources-and-data-models/pisp/domestic-payment-consents.html#get-domestic-payment-consents-consentid-funds-confirmation) | Paragraph refers to ‘Authorised’ and for consistency should be be updated to ‘AUTH’ |
| [OBWriteDomesticResponse5/Data/StatusReason/StatusReasonCode](https://openbankinguk.github.io/spec-preview-268/v4.0/resources-and-data-models/pisp/domestic-payments.html#data-dictionary-2) | Codeset should point to OBExternalStatusReason1Code |
| [OBMultiAuthorisation1/Status](https://openbankinguk.github.io/spec-preview-268/v4.0/profiles/payment-initiation-api-profile.html#data-dictionary-4) | Codeset should point to OBExternalStatus2Code |
| [domestic-vrp-consents](https://openbankinguk.github.io/spec-preview-268/v4.0/profiles/vrp-profile.html#consent-re-authentication) | Wording updated to clarify use of CANC |
| [Create Domestic Standing Order Consent example](https://openbankinguk.github.io/spec-preview-268/v4.0/resources-and-data-models/pisp/domestic-standing-order-consents.html#post-domestic-standing-order-consents-2) | JSON example frequency information needs updating |
| [OBDomestic2 DebtorAccount and Debtor share base class](https://openbankinguk.github.io/spec-preview-268/v4.0/resources-and-data-models/pisp/domestic-payment-consents.html#data-dictionary) | Class definitions need updating to reflect different fields, swaggers have in-line definitions |
| [OBDomesticVRPInitiation and OBDomesticVRPInstruction contain CreditorAgent](https://openbankinguk.github.io/spec-preview-268/v4.0/resources-and-data-models/vrp/domestic-vrp-consents.html#obdomesticvrpinitiation) | This was removed in KI v319_KI9 but was not removed from spec pages. |
| [OBRemittanceInformation2/Unstructured](https://openbankinguk.github.io/spec-preview-268/v4.0/profiles/payment-initiation-api-profile.html#data-dictionary-9)  | Data dictionary class column should be updated to clarify this is an array of Max140Text values. |
| [OBWritePaymentDetails1](https://openbankinguk.github.io/spec-preview-268/v4.0/resources-and-data-models/pisp/domestic-payments.html#uml-diagram-3) | UML shows incorrect cardinality for Data and PaymentDetails. |
| [GET /file-payments/{FilePaymentId}](https://openbankinguk.github.io/spec-preview-268/v4.0/resources-and-data-models/pisp/file-payments.html#get-file-payments-filepaymentid) | Table for POST /file-payments has duplicated down, and is showing instead of the correct table. |
| [VRP State model description](https://openbankinguk.github.io/spec-preview-268/v4.0/resources-and-data-models/vrp/domestic-vrp-consents.html#state-model-vrp-consents) | StatusCode is misspelled |
| ToC links - various  | Some links are not taking you to relevant section on the page when clicked (note, these have been broken since v3) |


| Area | Changes |
| --- | --- |
| [OBRisk1](https://openbankinguk.github.io/spec-preview-268/v4.0/profiles/payment-initiation-api-profile.html#data-dictionary) | <ul><li>Fixed `CareOf` entry in the data dictionary which had split across multiple lines</li><li>Addressed missing `/` in `OBRisk1/DeliveryAddress/DistrictName` XPath entry</li><li>Addressed missing `/` in `OBRisk1/DeliveryAddress StreetName` XPath entry</li><li>Addressed missing `/` in `OBRisk1/DeliveryAddress/TownLocationName` XPath entry</li><li>Restored truncated text from `OBRisk1/PaymentContextCode` class description entry (link to codeset repo)</li><li>Restored definition for `OBRisk1/PaymentPurposeCode` and fixed link to codeset repo</li><li>`OBRisk1/DeliveryAddress/AddressType` description and class columns contained merged data</li></ul> |
| [OBWritePaymentDetailsResponse1](https://openbankinguk.github.io/spec-preview-268/v4.0/profiles/payment-initiation-api-profile.html#data-dictionary-7) | <ul><li>Removed `OBWritePaymentDetailsResponse1/Data/StatusDetail/StatusUpdateDateTime` entry from data dictionary</li><li>Restored field size listing for `OBWritePaymentDetails1/StatusDetail/StatusReasonDescription` to `Max256Text`</li><li>Corrected `OBWritePaymentDetailsResponse1/Data/StatusDetail/StatusReason` name from StatusReasonCode to StatusReason</li><li>Codesets updated in data dictionary</li><li>Restored original UML diagram layout without `Meta` or `Links`</li></ul> |
| [OBDomestic2](https://openbankinguk.github.io/spec-preview-268/v4.0/resources-and-data-models/pisp/domestic-payment-consents.html#data-dictionary) | Restored missing `Proxy` to `OBDomestic2/CreditorAccount` |
| [OBRemittanceInformation2](https://openbankinguk.github.io/spec-preview-268/v4.0/profiles/payment-initiation-api-profile.html#data-dictionary-9) | `OBRemittanceInformation2/Structured/ReferredDocumentInformation/RelatedDate` type `ISODateTime` was truncated in data dictionary. |
| [OBInternationalRefundAccount1](https://openbankinguk.github.io/spec-preview-268/v4.0/profiles/payment-initiation-api-profile.html#data-dictionary-6) | Updated `OBInternationalRefundAccount1/Creditor/LEI` description to align with rest of spec |
| [OBWriteDomesticScheduledConsentResponse5](https://openbankinguk.github.io/spec-preview-268/v4.0/resources-and-data-models/pisp/domestic-scheduled-payment-consents.html#data-dictionary-3) | <li>`OBWriteDomesticScheduledConsentResponse5/Data/Status codeset` corrected to `OBInternalConsentStatus1Code`</li><li>`OBWriteDomesticScheduledConsentResponse5/Data/StatusReason/StatusReasonCode` codeset corrected to `OBExternalStatusReason1Code`</li></ul> |
| [OBWriteDomesticScheduledResponse5](https://openbankinguk.github.io/spec-preview-268/v4.0/resources-and-data-models/pisp/domestic-scheduled-payments.html#data-dictionary-2) | `OBWriteDomesticScheduledResponse5/Data/Status` codeset updated to `ExternalPaymentTransactionStatus1Code` and link to codesets added. |
| [OBWriteDomesticStandingOrderConsentResponse6](https://openbankinguk.github.io/spec-preview-268/v4.0/resources-and-data-models/pisp/domestic-standing-order-consents.html#data-dictionary-3) | <ul><li>`OBWriteDomesticStandingOrderConsentResponse6/Data/Status` codeset updated to `OBInternalConsentStatus1Code` </li><li>`OBWriteDomesticStandingOrderConsentResponse6/Data/StatusReason/StatusReasonCode` codeset updated to `OBExternalStatusReason1Code` </li></ul>|
| [OBWriteFileConsentResponse4](https://openbankinguk.github.io/spec-preview-268/v4.0/resources-and-data-models/pisp/file-payment-consents.html#data-dictionary-3) | `OBWriteFileConsentResponse4/Data/Status` codeset updated to `OBInternalConsentStatus1Code` |
| [OBWriteFileConsentResponse4](https://openbankinguk.github.io/spec-preview-268/v4.0/resources-and-data-models/pisp/file-payment-consents.html#data-dictionary-3) | `OBWriteFileConsentResponse4/Data/StatusReason/StatusReasonCode` codeset updated to `OBExternalStatusReason1Code` |
| [OBInternational3](https://openbankinguk.github.io/spec-preview-268/v4.0/resources-and-data-models/pisp/international-payment-consents.html#data-dictionary) | Erroneous `OBInternational3/Purpose` removed |
| [OBWriteInternationalConsentResponse6](https://openbankinguk.github.io/spec-preview-268/v4.0/resources-and-data-models/pisp/international-payment-consents.html#data-dictionary-4) | <ul><li>`OBWriteInternationalConsentResponse6/Data/Status` codeset updated to `OBInternalConsentStatus1Code`</li><li>`OBWriteInternationalConsentResponse6/Data/StatusReason/StatusReasonCode` codeset updated to `OBExternalStatusReason1Code`</li><li>XPath and Description for `OBWriteInternationalConsentResponse6/Data/Debtor/LEI` had merged</li></ul> |
| [International Paymnet funds-confirmation description](https://openbankinguk.github.io/spec-preview-268/v4.0/resources-and-data-models/pisp/international-payment-consents.html#get-international-payment-consents-consentid-funds-confirmation) | Removed reference to `OBInternalPermissions1Code` codeset |
| [OBInternationalScheduled3](https://openbankinguk.github.io/spec-preview-268/v4.0/resources-and-data-models/pisp/international-scheduled-payment-consents.html#data-dictionary) | Erroneous `OBInternationalScheduled3/Purpose` removed |
| [OBInternationalStandingOrder4](https://openbankinguk.github.io/spec-preview-268/v4.0/resources-and-data-models/pisp/international-standing-order-consents.html#data-dictionary) | Erroneous `OBInternationalStandingOrder4/Purpose` removed |
| `OBInternalFinancialInstitutionIdentification4Code` | A number of instances of this codeset were incorrectly truncated to `OBInternalFinancialInstitutionIdentification4Co` in data dictionary listings |
| [OBWriteFileResponse3](https://openbankinguk.github.io/spec-preview-268/v4.0/resources-and-data-models/pisp/file-payments.html#data-dictionary-2) | `OBWriteFileResponse3/Data/StatusReason/StatusReasonCode` codeset updated to `OBExternalStatusReason1Code` |
| [OBDomesticStandingOrder3](https://openbankinguk.github.io/spec-preview-268/v4.0/resources-and-data-models/pisp/domestic-standing-order-consents.html#data-dictionary) | `OBDomesticStandingOrder3/FirstPaymentAmount` fields were present but top level entry had merged. |
| [File paymnets state model](https://openbankinguk.github.io/spec-preview-268/v4.0/resources-and-data-models/pisp/file-payments.html#state-model) | Initiation state model was not present |
| [Date format description](https://openbankinguk.github.io/spec-preview-268/v4.0/profiles/read-write-data-api-profile.html#date-formats) | Description was showing old error enum value |
| CEG links | Some CEG links were not working |
| [Codeset repo link](https://openbankinguk.github.io/spec-preview-268/v4.0/profiles/read-write-data-api-profile.html#enumerations) | Corrected spelling of 'repository' |
| [AISP Consent](https://openbankinguk.github.io/spec-preview-268/v4.0/profiles/account-and-transaction-api-profile.html#consent-re-authentication) | Clarified use of `CANC` in AISP Consent Re-authentication |
| [OBDomesticVRPConsentResponse](https://openbankinguk.github.io/spec-preview-268/v4.0/resources-and-data-models/vrp/domestic-vrp-consents.html#obdomesticvrpconsentresponse) | Updated data dictionary with codeset name for `Status` and link to codeset repository |
| [OBDomesticVRPResponse](https://openbankinguk.github.io/spec-preview-268/v4.0/resources-and-data-models/vrp/domestic-vrps.html#obdomesticvrpresponse) | <ul><li>Updated data dictionary with codeset name for `Status` and link to codeset repository</li><li>Aligned 'Type' of `StatusReason` to `OBStatusReason`, consistent with other entries in spec</li></ul> |
| [OBWriteDomesticScheduledResponse5](https://openbankinguk.github.io/spec-preview-268/v4.0/resources-and-data-models/pisp/domestic-scheduled-payments.html#data-dictionary-2) | `OBWriteDomesticScheduledResponse5/Data/StatusReason/StatusReasonCode` updated codeset to `OBExternalStatusReason1Code` |
| [OBSCASupportData1](https://openbankinguk.github.io/spec-preview-268/v4.0/profiles/payment-initiation-api-profile.html#data-dictionary-8) | `SCASupportData/AppliedAuthenticationApproach` Removed erroneous description in class column |
| [SCASupportData](https://openbankinguk.github.io/spec-preview-268/v4.0/profiles/payment-initiation-api-profile.html#data-dictionary-8) | Class and description colummn entries were swapped for `SCASupportData/RequestedSCAExemptionType` |
| [domestic-vrps](https://openbankinguk.github.io/spec-preview-268/v4.0/resources-and-data-models/vrp/domestic-vrps.html#get-domestic-vrps-domesticvrpid) | `PATC` was incorrectly included in payment status list |
| [OBInternationalRefundAccount1](https://openbankinguk.github.io/spec-preview-268/v4.0/profiles/payment-initiation-api-profile.html#data-dictionary-6) | `OBInternationalRefundAccount1/Account/SchemeName` description was missing from data dictionary |
| Example JSON | A number of example JSON have been updated |
 