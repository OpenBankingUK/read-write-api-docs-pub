(window.webpackJsonp=window.webpackJsonp||[]).push([[511],{1673:function(e,t,n){"use strict";n.r(t);var a=n(6),i=Object(a.a)({},(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[n("h1",{attrs:{id:"file-payments-api-profile-v3-1-2"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#file-payments-api-profile-v3-1-2"}},[e._v("#")]),e._v(" File Payments API Profile - v3.1.2")]),e._v(" "),n("ol",[n("li",[n("a",{attrs:{href:"#overview"}},[e._v("Overview")]),e._v(" "),n("ol",[n("li",[n("a",{attrs:{href:"#document-overview"}},[e._v("Document Overview")])])])]),e._v(" "),n("li",[n("a",{attrs:{href:"#basics"}},[e._v("Basics")]),e._v(" "),n("ol",[n("li",[n("a",{attrs:{href:"#overview-1"}},[e._v("Overview")]),e._v(" "),n("ol",[n("li",[n("a",{attrs:{href:"#steps"}},[e._v("Steps")])]),e._v(" "),n("li",[n("a",{attrs:{href:"#sequence-diagram"}},[e._v("Sequence Diagram")])])])])])])]),e._v(" "),n("h2",{attrs:{id:"overview"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#overview"}},[e._v("#")]),e._v(" Overview")]),e._v(" "),n("p",[e._v("The File Payments API Profile describes the flows for File Payments, which allows a Payment Initiation Service Provider ('PISP') to:")]),e._v(" "),n("ul",[n("li",[e._v("Register an intent to "),n("strong",[e._v("stage")]),e._v(" a file-payment consent.")]),e._v(" "),n("li",[e._v("Subsequently "),n("strong",[e._v("submit")]),e._v(" the file-payment for processing.")]),e._v(" "),n("li",[e._v("Optionally retrieve the status of a file-payment "),n("strong",[e._v("consent")]),e._v(" or file-payment "),n("strong",[e._v("resource")]),e._v(".")])]),e._v(" "),n("p",[e._v("This profile should be read in conjunction with a compatible Read/Write Data API Profile, a compatible Payment Initiation API Profile and compatible individual resources.")]),e._v(" "),n("h3",{attrs:{id:"document-overview"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#document-overview"}},[e._v("#")]),e._v(" Document Overview")]),e._v(" "),n("p",[e._v("This document consists of the following parts:")]),e._v(" "),n("p",[n("strong",[e._v("Overview:")]),e._v(" Provides an overview of the profile.")]),e._v(" "),n("p",[n("strong",[e._v("Basics:")]),e._v(" Identifies the flows.")]),e._v(" "),n("h2",{attrs:{id:"basics"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#basics"}},[e._v("#")]),e._v(" Basics")]),e._v(" "),n("h3",{attrs:{id:"overview-2"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#overview-2"}},[e._v("#")]),e._v(" Overview")]),e._v(" "),n("p",[e._v("File Payments allow a file of payments to be uploaded to an ASPSP for payment initiation.")]),e._v(" "),n("p",[e._v("The high-level flow for file-payments follow the flow for all other payment-order types (as described in the "),n("RouterLink",{attrs:{to:"/v3.1.2/profiles/payment-initiation-api-profile.html#overview-1"}},[e._v("Basics > Overview")]),e._v(" Section of Payment Initiation API Profile) however, with an additional step to upload the file. The step for staging the payment-order consent is broken into two steps:")],1),e._v(" "),n("ul",[n("li",[e._v("POST metadata of the file-payment for payment initiation.")]),e._v(" "),n("li",[e._v("POST the file of the file-payment for payment initiation.")])]),e._v(" "),n("h4",{attrs:{id:"steps"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#steps"}},[e._v("#")]),e._v(" Steps")]),e._v(" "),n("p",[e._v("Step 1: Agree File Payment-Order Initiation.")]),e._v(" "),n("p",[e._v("Step 2a: Setup File Payment-Order Consent (Metadata):")]),e._v(" "),n("ul",[n("li",[e._v("The PISP connects to the ASPSP that services the PSU's payment account and creates a new "),n("strong",[e._v("file-payment-consent")]),e._v(" resource. This JSON message contains the Metadata of the file payments file. The ASPSP responds with a ConsentId.")]),e._v(" "),n("li",[e._v("This step is carried out by making a "),n("strong",[e._v("POST")]),e._v(" request to the "),n("strong",[e._v("file-payment-consent")]),e._v(" resource.")])]),e._v(" "),n("p",[e._v("Step 2b: Setup File Payment-Order Consent (Upload File):")]),e._v(" "),n("ul",[n("li",[e._v("The PISP uploads the payment file to the "),n("strong",[e._v("file-payment-consent")]),e._v(" endpoint with ConsentId obtained in Step 2a.")]),e._v(" "),n("li",[e._v("ASPSP verifies the payment file against the hash of payment file received in the "),n("strong",[e._v("file-payment-consent")]),e._v(" Metadata in Step 2a.")]),e._v(" "),n("li",[e._v("ASPSP responds with 200 OK.")]),e._v(" "),n("li",[e._v("This step completes the "),n("strong",[e._v("file-payment-consent")]),e._v(" creation.")])]),e._v(" "),n("p",[e._v("Step 3: Authorise Consent.")]),e._v(" "),n("p",[e._v("Step 4: Create Payment-Order.")]),e._v(" "),n("p",[e._v("Step 5: Get Consent/Payment-Order/Payment-Details Status:")]),e._v(" "),n("ul",[n("li",[e._v("A PISP may optionally request the Status of the file-payment-consent.")]),e._v(" "),n("li",[e._v("A PISP may optionally request File uploaded to file-payment-consent, for verification.")]),e._v(" "),n("li",[e._v("A PISP may optionally request the Status of the file-payment.")]),e._v(" "),n("li",[e._v("A PISP may optionally request a report in a file format, on the status of the individual payments in file-payments, if the ASPSP makes this available.")]),e._v(" "),n("li",[e._v("A PISP may optionally request the detail status of the individual payments in file-payments, if the ASPSP makes this available.")])]),e._v(" "),n("h4",{attrs:{id:"sequence-diagram"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#sequence-diagram"}},[e._v("#")]),e._v(" Sequence Diagram")]),e._v(" "),n("p",[n("img",{attrs:{src:"images/FilePaymentStatusv4-draft7.png",alt:"File Payment Initiation - High Level Flow"}})]),e._v(" "),n("details",[n("Summary",[e._v("Diagram source")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("participant PSU\nparticipant PISP\nparticipant ASPSP Authorisation Server\nparticipant ASPSP Resource Server\n\nnote over PSU, ASPSP Resource Server\nStep 1: Agree File Payment-Order Initiation\nend note\n\nnote over PSU, ASPSP Resource Server\nStep 2: Setup Agree File Payment-Order Consent\nend note\nPISP -> ASPSP Authorisation Server: Initiate Client Credentials Grant\nASPSP Authorisation Server -> PISP: access-token\nnote right of PISP\n   Step 2a: Setup File Payment-Order Consent (Metadata, including Hash)\nend note\nPISP -> ASPSP Resource Server: POST /file-payment-consents\nstate over ASPSP Resource Server: Consent Status: AwaitingUpload\nASPSP Resource Server -> PISP: HTTP 201 (Created),  ConsentId\nnote right of PISP\n   Step 2b: Upload File using Consent Id\nend note\nPISP -> ASPSP Resource Server: POST /file-payment-consents/{ConsentId}/file\nstate over ASPSP Resource Server: Consent Status: AwaitingAuthorisation\nASPSP Resource Server -> PISP: HTTP 200 (OK)\nPISP -> PSU: HTTP 302 (Found), Redirect (ConsentId)\n\nnote over PSU, ASPSP Resource Server\nStep 3: Authorize File Payment-Order Consent\nend note\nnote over PSU, ASPSP Resource Server\nStep 4: Create File Payment-Order\nend note\n\nnote over PSU, ASPSP Resource Server\nStep 5: Get File Payment Consent Status/ Payment File/ File Payment Status/ Payment Report File/ File Payment-Payment Details Status\nend note\n\nopt File Payment consent\nPISP -> ASPSP Resource Server: GET /file-payment-consents/{ConsentId}\nASPSP Resource Server -> PISP: HTTP 200 (OK) file-payment-consent resource\nend opt\n\nopt File uloaded with File Payment consent\nPISP -> ASPSP Resource Server: GET file-payment-consents/{ConsentId}/file\nASPSP Resource Server -> PISP: HTTP 200 (OK) file resource\nend opt\n\nopt File Payment status\nPISP -> ASPSP Resource Server: GET /file-payments/{FilePaymentId}\nASPSP Resource Server -> PISP: HTTP 200 (OK) file-payment resource\nend opt\n\nopt File Payment report file\nPISP -> ASPSP Resource Server: GET /file-payments/{FilePaymentId}/report-file\nASPSP Resource Server -> PISP: HTTP 200 (OK) file resource\nend opt\n\nopt Payment Status File Payment\nPISP -> ASPSP Resource Server: GET /file-payments/{FilePaymentId}/payment-details\nASPSP Resource Server -> PISP: HTTP 200 (OK) file resource\nend opt\n\noption footer=bar\n")])])])],1)])}),[],!1,null,null,null);t.default=i.exports}}]);